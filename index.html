<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debate Hero - ESL è¾¯è«–éŠæˆ²åŒ–å¹³å°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Bungee&family=Inter:wght@300;400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f0f4f8; }
        .game-font { font-family: 'Bungee', cursive; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .card { transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .xp-bar-fill { transition: width 0.5s ease-out; }
        .badge-locked { filter: grayscale(1) opacity(0.3); }
        .badge-unlocked { animation: pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes pop { 0% { transform: scale(0.5); } 100% { transform: scale(1); } }
        .animate-bounce-short { animation: bounce 1s ease-in-out 1; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
    </style>
</head>
<body class="text-slate-800">

    <!-- Top Game Bar -->
    <div class="bg-slate-900 text-white sticky top-0 z-50 shadow-md">
        <div class="max-w-5xl mx-auto px-4 py-2 flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <div class="bg-indigo-600 rounded-full h-10 w-10 flex items-center justify-center border-2 border-white">
                    <span id="player-level" class="game-font text-lg">1</span>
                </div>
                <div>
                    <div class="text-[10px] uppercase font-bold text-slate-400 leading-none mb-1">Level <span id="lvl-display">1</span> Novice</div>
                    <div class="w-24 md:w-48 bg-slate-700 h-2 rounded-full overflow-hidden">
                        <div id="xp-bar" class="xp-bar-fill bg-indigo-400 h-full" style="width: 0%"></div>
                    </div>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <div class="text-center">
                    <div id="total-xp" class="game-font text-lg text-yellow-400">0</div>
                    <div class="text-[8px] uppercase font-bold text-slate-400 font-sans">Total XP</div>
                </div>
                <div id="badge-preview" class="hidden md:flex space-x-2">
                    <i class="fas fa-hammer text-slate-500 text-sm badge-locked" title="AREL Architect"></i>
                    <i class="fas fa-users text-slate-500 text-sm badge-locked" title="Stakeholder Explorer"></i>
                    <i class="fas fa-shield-alt text-slate-500 text-sm badge-locked" title="Rebuttal Master"></i>
                    <i class="fas fa-brain text-slate-500 text-sm badge-locked" title="Logic Pro"></i>
                    <i class="fas fa-microphone text-slate-500 text-sm badge-locked" title="Speech King"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="bg-indigo-700 text-white py-10 px-4 text-center">
        <h1 class="text-4xl font-extrabold mb-2 game-font tracking-wider text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 to-white">DEBATE HERO</h1>
        <p class="text-indigo-100 italic text-sm">Level Up Your Logic, Master Your Speech</p>
    </header>

    <!-- Navigation -->
    <nav class="bg-white border-b sticky top-14 z-10 overflow-x-auto shadow-sm">
        <div class="max-w-5xl mx-auto flex whitespace-nowrap">
            <button onclick="showTab('phase1')" class="tab-btn px-5 py-4 font-bold text-indigo-600 border-b-4 border-indigo-600 active" data-target="phase1"><i class="fas fa-hammer mr-1 text-xs"></i>è«–è­‰ (AREL)</button>
            <button onclick="showTab('phase2')" class="tab-btn px-5 py-4 font-bold text-slate-500 hover:text-indigo-600 transition" data-target="phase2"><i class="fas fa-users mr-1 text-xs"></i>åˆ©å®³é—œä¿‚</button>
            <button onclick="showTab('phase3')" class="tab-btn px-5 py-4 font-bold text-slate-500 hover:text-indigo-600 transition" data-target="phase3"><i class="fas fa-shield-alt mr-1 text-xs"></i>åé§</button>
            <button onclick="showTab('phase4')" class="tab-btn px-5 py-4 font-bold text-slate-500 hover:text-indigo-600 transition" data-target="phase4"><i class="fas fa-search mr-1 text-xs"></i>è¬¬èª¤åµæ¢</button>
            <button onclick="showTab('phase5')" class="tab-btn px-5 py-4 font-bold text-slate-500 hover:text-indigo-600 transition" data-target="phase5"><i class="fas fa-microphone mr-1 text-xs"></i>å³èˆˆæ¼”èªª</button>
        </div>
    </nav>

    <main class="max-w-4xl mx-auto p-4 md:p-8">

        <!-- Phase 1: AREL Builder -->
        <section id="phase1" class="tab-content active">
            <div class="bg-white rounded-2xl shadow-xl p-6 border-2 border-indigo-100">
                <div class="flex justify-between items-start mb-6">
                    <h2 class="text-2xl font-bold text-indigo-700">AREL è«–è­‰ç”¢ç”Ÿå™¨</h2>
                    <span class="bg-yellow-100 text-yellow-700 text-xs font-bold px-2 py-1 rounded-full">+50 XP</span>
                </div>

                <div class="mb-8 space-y-4">
                    <div class="bg-slate-50 p-5 rounded-xl border border-slate-200">
                        <h3 class="font-bold text-slate-800 mb-2 flex items-center text-sm">
                            <i class="fas fa-question-circle mr-2 text-indigo-500"></i> ç‚ºä»€éº¼è¦ç·´ç¿’ AREL çµæ§‹ï¼Ÿ
                        </h3>
                        <p class="text-[13px] text-slate-600 leading-relaxed italic">
                            AREL ç¢ºä¿ä½ çš„ç™¼è¨€ä¸åƒ…åƒ…æ˜¯å€‹äººè§€é»ï¼Œè€Œæ˜¯ç¶“éé‚è¼¯æ¨ç† (Reasoning) ä¸¦æœ‰è­‰æ“š (Evidence) æ”¯æŒçš„å¼·å¤§è«–è­‰ã€‚å®ƒæ˜¯è¾¯è«–çš„ã€Œéª¨æ¶ã€ã€‚
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Example 1 -->
                        <div class="bg-indigo-50 border-2 border-dashed border-indigo-200 rounded-xl p-4 text-[11px] leading-snug card">
                            <h3 class="font-bold text-indigo-800 mb-2 italic">ç¯„ä¾‹ Aï¼šåˆ¶æœæ”¿ç­–</h3>
                            <p><span class="font-bold">Assertion (ä¸»å¼µ):</span> Uniforms should be mandatory.</p>
                            <p class="text-slate-500 border-b mb-1 pb-1">å­¸æ ¡æ‡‰å¼·åˆ¶ç©¿åˆ¶æœã€‚</p>
                            <p><span class="font-bold">Reasoning (ç†ç”±):</span> It reduces social pressure among students.</p>
                            <p class="text-slate-500 border-b mb-1 pb-1">å› ç‚ºé€™èƒ½æ¸›å°‘å­¸ç”Ÿé–“çš„ç¤¾äº¤å£“åŠ›ã€‚</p>
                            <p><span class="font-bold">Evidence (è­‰æ“š):</span> Studies show 60% of students feel less bullied.</p>
                            <p class="text-slate-500">ç ”ç©¶é¡¯ç¤º 60% çš„å­¸ç”Ÿæ„Ÿåˆ°éœ¸å‡Œæ¸›å°‘ã€‚</p>
                        </div>
                        <!-- Example 2 -->
                        <div class="bg-blue-50 border-2 border-dashed border-blue-200 rounded-xl p-4 text-[11px] leading-snug card">
                            <h3 class="font-bold text-blue-800 mb-2 italic">ç¯„ä¾‹ Bï¼šç¤¾ç¾¤åª’é«”</h3>
                            <p><span class="font-bold">Assertion:</span> Social media harms teenagers.</p>
                            <p class="text-slate-500 border-b mb-1 pb-1">ç¤¾ç¾¤åª’é«”å°é’å°‘å¹´æœ‰å®³ã€‚</p>
                            <p><span class="font-bold">Reasoning:</span> It leads to toxic social comparisons.</p>
                            <p class="text-slate-500 border-b mb-1 pb-1">å°è‡´æœ‰å®³çš„ç›¸äº’æ”€æ¯”ã€‚</p>
                            <p><span class="font-bold">Evidence:</span> Anxiety rates increased by 70% among heavy users.</p>
                            <p class="text-slate-500">é‡åº¦ä½¿ç”¨è€…ç„¦æ…®ç‡ä¸Šå‡äº† 70%ã€‚</p>
                        </div>
                    </div>
                </div>

                <div class="space-y-4">
                    <label class="block text-xs font-bold text-slate-400 uppercase tracking-widest">ç¾åœ¨é–‹å§‹å»ºç«‹ä½ çš„è«–é»ï¼š</label>
                    <input id="arel-a" type="text" placeholder="Assertion (ä½ çš„æ ¸å¿ƒä¸»å¼µ)..." class="w-full p-3 border-2 border-slate-100 rounded-xl focus:border-indigo-400 outline-none transition">
                    <textarea id="arel-r" rows="2" placeholder="Reasoning (ç‚ºä»€éº¼ä½ çš„ä¸»å¼µæ˜¯å°çš„ï¼Ÿ)..." class="w-full p-3 border-2 border-slate-100 rounded-xl focus:border-indigo-400 outline-none transition"></textarea>
                    <textarea id="arel-e" rows="2" placeholder="Evidence (èˆ‰å‡ºä¾‹å­ã€ç ”ç©¶æˆ–æ•¸æ“š)..." class="w-full p-3 border-2 border-slate-100 rounded-xl focus:border-indigo-400 outline-none transition"></textarea>
                    <input id="arel-l" type="text" placeholder="Link-back (ç¸½çµä¸¦å›æ‰£è¾¯é¡Œ)..." class="w-full p-3 border-2 border-slate-100 rounded-xl focus:border-indigo-400 outline-none transition">
                </div>
                <button onclick="generateAREL()" class="mt-6 w-full bg-indigo-600 text-white font-bold py-4 rounded-xl hover:bg-indigo-700 transition shadow-lg transform active:scale-95">ç”¢å‡ºå®Œæ•´è«–é»ç¨¿ä»¶ <i class="fas fa-magic ml-2"></i></button>
                
                <div id="arel-result" class="hidden mt-6 p-6 bg-slate-900 text-indigo-300 rounded-xl relative italic text-lg text-center">
                    <p id="arel-text"></p>
                    <button onclick="copyAREL()" class="mt-4 text-sm text-indigo-400 font-bold hover:text-white transition underline">è¤‡è£½åˆ°å‰ªè²¼ç°¿</button>
                </div>
            </div>
        </section>

        <!-- Phase 2: Stakeholders -->
        <section id="phase2" class="tab-content">
            <div class="bg-white rounded-2xl shadow-xl p-6 border-2 border-emerald-100">
                <div class="flex justify-between items-start mb-6">
                    <h2 class="text-2xl font-bold text-emerald-700">åˆ©å®³é—œä¿‚åˆ†æ (Stakeholders)</h2>
                    <span class="bg-emerald-100 text-emerald-700 text-xs font-bold px-2 py-1 rounded-full">+10 XP</span>
                </div>

                <div class="mb-8 space-y-4">
                    <div class="bg-slate-50 p-5 rounded-xl border border-slate-200">
                        <h3 class="font-bold text-slate-800 mb-2 flex items-center text-sm">
                            <i class="fas fa-question-circle mr-2 text-emerald-500"></i> ä»€éº¼æ˜¯åˆ©å®³é—œä¿‚äººï¼Ÿ
                        </h3>
                        <p class="text-[13px] text-slate-600 leading-relaxed mb-3">
                            åœ¨è¾¯è«–ä¸­ï¼Œä¸€é …æ”¿ç­–æœƒå°ä¸åŒçš„<b>ç¾¤é«”</b>ç”¢ç”Ÿä¸åŒçš„å½±éŸ¿ã€‚åˆ†æä»–å€‘èƒ½è®“ä½ çš„è«–é»æ›´æœ‰æ·±åº¦ï¼Œä¸¦è­‰æ˜æ”¿ç­–çš„ã€Œå½±éŸ¿åŠ› (Impact)ã€ã€‚ä»–å€‘å°±åƒæ˜¯ä½ æˆ°å ´ä¸Šçš„åµå¯Ÿå…µã€‚
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Example A -->
                        <div class="bg-emerald-50 p-4 rounded-xl border border-emerald-200 card shadow-sm">
                            <h3 class="font-bold text-emerald-800 mb-2 text-xs italic"><i class="fas fa-lightbulb mr-1"></i> ç¯„ä¾‹ Aï¼šç¦ç”¨å¡‘è† è¢‹</h3>
                            <div class="text-[10px] space-y-1">
                                <p><span class="font-bold text-emerald-700">Marine Life:</span> Benefit from cleaner oceans. (æ¸›å°‘èª¤é£Ÿ)</p>
                                <p><span class="font-bold text-emerald-700">Shoppers:</span> Extra cost for reusable bags. (ç’°ä¿è¢‹è² æ“”)</p>
                            </div>
                        </div>
                        <!-- Example B -->
                        <div class="bg-indigo-50 p-4 rounded-xl border border-indigo-200 card shadow-sm">
                            <h3 class="font-bold text-indigo-800 mb-2 text-xs italic"><i class="fas fa-calendar-alt mr-1"></i> ç¯„ä¾‹ Bï¼šæ¯é€±å››å¤©åˆ¶</h3>
                            <div class="text-[10px] space-y-1">
                                <p><span class="font-bold text-indigo-700">Students:</span> More time for mental health. (ä¼‘æ¯æ™‚é–“)</p>
                                <p><span class="font-bold text-indigo-700">Parents:</span> Extra childcare expenses. (é¡å¤–æ‰˜è‚²è²»)</p>
                            </div>
                        </div>
                    </div>
                </div>

                <hr class="mb-8 border-slate-100">

                <div class="mb-6 relative">
                    <label class="block text-xs font-black text-emerald-600 mb-3 uppercase tracking-widest">é¸æ“‡äº”å¤§é ˜åŸŸç·´ç¿’é¡Œç›®ï¼š</label>
                    <select id="motion-selector" onchange="updateStakeholders()" class="w-full p-4 border-4 border-emerald-100 rounded-2xl bg-emerald-50 text-emerald-900 font-black outline-none shadow-inner appearance-none text-sm">
                        <option value="edu">1. [æ•™è‚²] å¯¦æ–½æ¯é€±å››å¤©å·¥ä½œ/ä¸Šèª²åˆ¶</option>
                        <option value="tech">2. [ç§‘æŠ€] ç¦æ­¢ AI ç”Ÿæˆè—è¡“åƒåŠ æ¯”è³½</option>
                        <option value="env">3. [ç’°å¢ƒ] å°è‚‰é¡å¾µæ”¶ã€Œç’°å¢ƒç¨…ã€</option>
                        <option value="econ">4. [ç¶“æ¿Ÿ] æä¾›ç„¡æ¢ä»¶åŸºæœ¬æ”¶å…¥ (UBI)</option>
                        <option value="law">5. [å¸æ³•] é–‹æ”¾é›»è¦–è½‰æ’­æ³•åº­å¯©ç†</option>
                    </select>
                    <div class="absolute right-4 top-[70%] -translate-y-1/2 pointer-events-none text-emerald-700"><i class="fas fa-chevron-down"></i></div>
                </div>

                <div id="stakeholder-grid" class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"></div>

                <div id="ref-answer-container" class="mt-8">
                    <button onclick="toggleRef()" id="ref-toggle-btn" class="w-full bg-slate-800 text-white font-bold py-4 rounded-xl shadow-lg">è§£é–å°ˆå®¶åˆ†æ (åƒè€ƒè§£ç­”)</button>
                    <div id="ref-answer-text" class="hidden mt-4 p-5 bg-amber-50 border-2 border-amber-200 rounded-xl text-[13px] leading-relaxed text-slate-700"></div>
                </div>
            </div>
        </section>

        <!-- Phase 3: Rebuttal Workshop -->
        <section id="phase3" class="tab-content">
            <div class="bg-white rounded-2xl shadow-xl p-6 border-2 border-rose-100">
                <div class="flex justify-between items-start mb-6">
                    <h2 class="text-2xl font-bold text-rose-700">åé§å·¥ä½œåŠ (Rebuttal)</h2>
                    <span class="bg-rose-100 text-rose-700 text-xs font-bold px-2 py-1 rounded-full">+30 XP</span>
                </div>

                <div class="mb-8 space-y-4">
                    <div class="bg-slate-50 p-5 rounded-xl border border-slate-200">
                        <h3 class="font-bold text-slate-800 mb-2 flex items-center text-sm">
                            <i class="fas fa-shield-alt mr-2 text-rose-500"></i> åé§çš„æ„ç¾©èˆ‡å››æ­¥æ³•
                        </h3>
                        <p class="text-[13px] text-slate-600 leading-relaxed italic">
                            åé§æ˜¯ç‚ºäº†æŒ‡å‡ºå°æ–¹çš„é‚è¼¯æ¼æ´ã€‚è«‹ç·´ç¿’ä½¿ç”¨ï¼š1. They Say -> 2. But I Disagree -> 3. Therefore -> 4. Furthermoreã€‚
                        </p>
                    </div>

                    <!-- Useful Sentence Patterns -->
                    <div class="bg-rose-50 border-2 border-rose-100 rounded-xl p-5 shadow-sm">
                        <h3 class="font-bold text-rose-800 mb-4 flex items-center text-sm italic"><i class="fas fa-comments mr-2"></i> å¸¸ç”¨å¥å‹åº«</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-[10px]">
                            <div class="bg-white p-2 rounded"><b>Step 1:</b> My opponent claims that... (å°æ‰‹è²ç¨±...)</div>
                            <div class="bg-white p-2 rounded"><b>Step 2:</b> This is flawed because... (é€™é»æœ‰èª¤ï¼Œå› ç‚º...)</div>
                            <div class="bg-white p-2 rounded"><b>Step 3:</b> Thus, the impact is... (å› æ­¤å½±éŸ¿æ˜¯...)</div>
                            <div class="bg-white p-2 rounded"><b>Step 4:</b> Moreover, consider... (æ­¤å¤–ï¼Œè€ƒæ…®åˆ°...)</div>
                        </div>
                    </div>

                    <!-- 4 Case Studies -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mt-4">
                        <div class="p-3 bg-white border border-rose-100 rounded-xl text-[9px] shadow-sm">
                            <b class="text-rose-600 block mb-1">1. Homework Ban</b>
                            They say: Causes stress. <br>
                            Refute: It reinforces memory.
                        </div>
                        <div class="p-3 bg-white border border-rose-100 rounded-xl text-[9px] shadow-sm">
                            <b class="text-rose-600 block mb-1">2. Video Games</b>
                            They say: Makes kids violent. <br>
                            Refute: No direct link proven.
                        </div>
                        <div class="p-3 bg-white border border-rose-100 rounded-xl text-[9px] shadow-sm">
                            <b class="text-rose-600 block mb-1">3. Meat Tax</b>
                            They say: Hurts the poor. <br>
                            Refute: Revenue subsidizes plants.
                        </div>
                        <div class="p-3 bg-white border border-rose-100 rounded-xl text-[9px] shadow-sm">
                            <b class="text-rose-600 block mb-1">4. Free Transport</b>
                            They say: Helps the poor. <br>
                            Refute: Lower quality leads to no use.
                        </div>
                    </div>
                </div>

                <div class="bg-slate-900 text-white p-6 rounded-2xl mb-6 shadow-2xl border-l-8 border-rose-500 relative overflow-hidden">
                    <p class="text-[10px] font-black text-rose-400 uppercase mb-1 tracking-[0.2em] italic">Current Challenge:</p>
                    <select id="rebuttal-topic-selector" onchange="refreshClaim()" class="bg-transparent text-white font-bold border-none outline-none mb-4 text-sm w-full cursor-pointer">
                        <option value="edu" class="bg-slate-800 text-white">[æ•™è‚²] æ¯é€±å››å¤©åˆ¶</option>
                        <option value="tech" class="bg-slate-800 text-white">[ç§‘æŠ€] AI è—è¡“ç«¶è³½</option>
                        <option value="env" class="bg-slate-800 text-white">[ç’°å¢ƒ] è‚‰é¡ç’°å¢ƒç¨…</option>
                        <option value="econ" class="bg-slate-800 text-white">[ç¶“æ¿Ÿ] åŸºæœ¬æ”¶å…¥ (UBI)</option>
                        <option value="law" class="bg-slate-800 text-white">[å¸æ³•] æ³•åº­è½‰æ’­</option>
                    </select>
                    <div class="bg-white/10 p-4 rounded-xl"><p id="opponent-claim" class="text-lg italic font-bold leading-snug"></p></div>
                </div>

                <textarea id="rebuttal-input" rows="5" placeholder="å¯«ä¸‹ä½ çš„å››æ­¥æ³•åé§æŒ‘æˆ°..." class="w-full p-5 border-2 border-slate-100 rounded-2xl outline-none mb-4 focus:border-rose-400 transition text-sm shadow-inner"></textarea>
                <button onclick="submitRebuttal()" class="w-full bg-rose-600 text-white font-black py-4 rounded-xl shadow-lg transform active:scale-95 transition">æäº¤åé§ä¸¦è§£é–ç¯„ä¾‹</button>

                <div id="rebuttal-ref-container" class="mt-6 hidden">
                    <div class="p-5 bg-white border-2 border-rose-200 rounded-2xl shadow-xl">
                        <h4 class="font-bold text-rose-800 mb-3 flex items-center italic text-sm"><i class="fas fa-check-circle mr-2"></i> å°ˆå®¶ç´šåé§ç¤ºç¯„ (Expert Sample)</h4>
                        <div id="rebuttal-ref-text" class="space-y-2 text-[13px] leading-relaxed text-slate-700"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Phase 4: Fallacy Detective -->
        <section id="phase4" class="tab-content">
            <div class="bg-white rounded-2xl shadow-xl p-6 border-2 border-amber-100 text-center">
                <h2 class="text-2xl font-bold text-amber-700 mb-6 uppercase tracking-wider underline decoration-amber-200 decoration-4">è¬¬èª¤åµæ¢ (Fallacy Detective)</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-10 text-left">
                    <!-- A-Z Learning Cards -->
                    <div class="bg-amber-50 p-4 rounded-xl border border-amber-200 card">
                        <h4 class="font-bold text-amber-900 mb-1 flex justify-between text-sm"><span>Ad Hominem</span><span class="text-[10px] font-normal opacity-70">äººèº«æ”»æ“Š</span></h4>
                        <p class="text-[10px] text-slate-600 mb-2 italic">æ”»æ“Šäººï¼Œè€Œéé‚è¼¯ã€‚</p>
                        <div class="bg-white p-2 rounded text-[10px] italic border leading-tight">"His point is wrong because he's messy!" <br> (ä»–çš„è«–é»éŒ¯äº†ï¼Œå› ç‚ºä»–å¾ˆé‚‹é¢ï¼)</div>
                    </div>
                    <div class="bg-amber-50 p-4 rounded-xl border border-amber-200 card">
                        <h4 class="font-bold text-amber-900 mb-1 flex justify-between text-sm"><span>Circular Reasoning</span><span class="text-[10px] font-normal opacity-70">å¾ªç’°è«–è­‰</span></h4>
                        <p class="text-[10px] text-slate-600 mb-2 italic">ç†ç”±å°±æ˜¯çµè«–çš„é‡è¤‡ã€‚</p>
                        <div class="bg-white p-2 rounded text-[10px] italic border leading-tight">"It's good because it's beneficial." <br> (é€™æ˜¯å¥½çš„ï¼Œå› ç‚ºå®ƒæ˜¯æœ‰ç›Šçš„ã€‚)</div>
                    </div>
                    <div class="bg-amber-50 p-4 rounded-xl border border-amber-200 card">
                        <h4 class="font-bold text-amber-900 mb-1 flex justify-between text-sm"><span>False Dilemma</span><span class="text-[10px] font-normal opacity-70">éŒ¯èª¤äºŒåˆ†</span></h4>
                        <p class="text-[10px] text-slate-600 mb-2 italic">å‡è£åªæœ‰å…©ç¨®æ¥µç«¯é¸æ“‡ã€‚</p>
                        <div class="bg-white p-2 rounded text-[10px] italic border leading-tight">"Either buy this or walk forever." <br> (è¦å˜›è²·é€™å€‹ï¼Œè¦å˜›ä½ å°±èµ°è·¯ã€‚)</div>
                    </div>
                    <div class="bg-amber-50 p-4 rounded-xl border border-amber-200 card">
                        <h4 class="font-bold text-amber-900 mb-1 flex justify-between text-sm"><span>Red Herring</span><span class="text-[10px] font-normal opacity-70">ç´…é¯¡é­š</span></h4>
                        <p class="text-[10px] text-slate-600 mb-2 italic">è½‰ç§»è©±é¡Œè‡³ç„¡é—œçš„äº‹æƒ…ã€‚</p>
                        <div class="bg-white p-2 rounded text-[10px] italic border leading-tight">"Q: Money? A: I love my country!" <br> (å•éŒ¢åœ¨å“ªï¼Ÿç­”ï¼šæˆ‘å¾ˆæ„›åœ‹ï¼)</div>
                    </div>
                    <div class="bg-amber-50 p-4 rounded-xl border border-amber-200 card">
                        <h4 class="font-bold text-amber-900 mb-1 flex justify-between text-sm"><span>Slippery Slope</span><span class="text-[10px] font-normal opacity-70">æ»‘å¡è¬¬èª¤</span></h4>
                        <p class="text-[10px] text-slate-600 mb-2 italic">å°å‹•ä½œå¼•ç™¼ææ€–å¤§å¾Œæœã€‚</p>
                        <div class="bg-white p-2 rounded text-[10px] italic border leading-tight">"Skip one class, go to jail!" <br> (ç¿¹ä¸€å ‚èª²ï¼Œæœ€å¾Œæœƒå»åç‰¢ï¼)</div>
                    </div>
                    <div class="bg-amber-50 p-4 rounded-xl border border-amber-200 card">
                        <h4 class="font-bold text-amber-900 mb-1 flex justify-between text-sm"><span>Strawman</span><span class="text-[10px] font-normal opacity-70">ç¨»è‰äºº</span></h4>
                        <p class="text-[10px] text-slate-600 mb-2 italic">æ­ªæ›²ä¸»å¼µä»¥ä¾¿æ›´å®¹æ˜“æ”»æ“Šã€‚</p>
                        <div class="bg-white p-2 rounded text-[10px] italic border leading-tight">"A: Less homework. B: Lazy kids?" <br> (æ¸›å°‘ä½œæ¥­ = ä½ æƒ³è®“å°å­©è®Šæ‡¶ï¼Ÿ)</div>
                    </div>
                </div>

                <div class="flex justify-center mb-4"><span class="bg-amber-100 px-3 py-1 rounded-full text-amber-700 text-xs font-bold shadow-sm">Streak: <span id="streak-val">0</span> ğŸ”¥</span></div>
                <div id="fallacy-q" class="bg-slate-900 text-white p-8 rounded-3xl mb-8 min-h-[140px] flex items-center justify-center italic text-lg border-4 border-slate-700 shadow-2xl">Loading challenge...</div>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2">
                    <button onclick="checkFallacy(this, 'Ad Hominem')" class="p-2 border-2 rounded-xl font-bold text-[10px] hover:bg-amber-400 hover:text-white transition uppercase">Ad Hominem</button>
                    <button onclick="checkFallacy(this, 'Circular Reasoning')" class="p-2 border-2 rounded-xl font-bold text-[10px] hover:bg-amber-400 hover:text-white transition uppercase text-[9px]">Circular</button>
                    <button onclick="checkFallacy(this, 'False Dilemma')" class="p-2 border-2 rounded-xl font-bold text-[10px] hover:bg-amber-400 hover:text-white transition uppercase">False Dilemma</button>
                    <button onclick="checkFallacy(this, 'Red Herring')" class="p-2 border-2 rounded-xl font-bold text-[10px] hover:bg-amber-400 hover:text-white transition uppercase text-[9px]">Red Herring</button>
                    <button onclick="checkFallacy(this, 'Slippery Slope')" class="p-2 border-2 rounded-xl font-bold text-[10px] hover:bg-amber-400 hover:text-white transition uppercase text-[9px]">Slippery Slope</button>
                    <button onclick="checkFallacy(this, 'Strawman')" class="p-2 border-2 rounded-xl font-bold text-[10px] hover:bg-amber-400 hover:text-white transition uppercase">Strawman</button>
                </div>
            </div>
        </section>

        <!-- Phase 5: Table Topics -->
        <section id="phase5" class="tab-content">
            <div class="bg-white rounded-2xl shadow-xl p-6 border-2 border-blue-100 text-center">
                <h2 class="text-2xl font-bold text-blue-700 mb-4">å³èˆˆæ¼”èªªç«¶æŠ€å ´</h2>
                <div class="mb-8 bg-slate-50 p-5 rounded-xl border border-slate-200 text-left">
                    <h3 class="font-bold text-slate-800 mb-2 flex items-center text-sm"><i class="fas fa-bolt mr-2 text-blue-500"></i> ç‚ºä»€éº¼è¦ç·´ç¿’å³èˆˆæ¼”èªªï¼Ÿ</h3>
                    <p class="text-[13px] text-slate-600 leading-relaxed italic">é€™æ˜¯ä½ å¤§è…¦çš„å¥èº«æˆ¿ã€‚è¨“ç·´ä½ åœ¨çŸ­æ™‚é–“å…§å°‡è¢«å‹•ç†è§£è½‰åŒ–ç‚ºä¸»å‹•è¼¸å‡ºï¼Œæå‡èªæ„Ÿèˆ‡è‡ªä¿¡ã€‚</p>
                </div>
                <div id="random-topic" class="text-2xl font-bold mb-6 italic text-blue-900 leading-snug">æº–å‚™å¥½å¾ŒæŒ‰ä¸‹æŠ½é¡Œ</div>
                <div id="timer-display" class="game-font text-7xl text-blue-500 mb-8 drop-shadow-sm font-sans">01:00</div>
                <div class="flex justify-center space-x-4">
                    <button onclick="newTopic()" class="bg-blue-600 text-white px-10 py-4 rounded-full font-black hover:scale-105 shadow-lg transition">æŠ½é¡Œ</button>
                    <button id="timer-btn" onclick="toggleTimer()" class="bg-yellow-400 text-slate-900 px-10 py-4 rounded-full font-black disabled:opacity-50 shadow-lg" disabled>é–‹å§‹ä»»å‹™</button>
                </div>
            </div>
        </section>
    </main>

    <script>
        let state = { xp: 0, level: 1, streak: 0, badges: { arel: false, stakeholder: false, rebuttal: false, fallacy: false, speech: false } };
        const XP_PER_LEVEL = 200;

        function addXP(amount) {
            state.xp += amount;
            const newLevel = Math.floor(state.xp / XP_PER_LEVEL) + 1;
            if (newLevel > state.level) {
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
            }
            state.level = newLevel;
            updateUI();
        }

        function updateUI() {
            const txp = document.getElementById('total-xp');
            const ldi = document.getElementById('lvl-display');
            const plv = document.getElementById('player-level');
            const xpb = document.getElementById('xp-bar');
            if(txp) txp.innerText = state.xp;
            if(ldi) ldi.innerText = state.level;
            if(plv) plv.innerText = state.level;
            if(xpb) xpb.style.width = `${((state.xp % XP_PER_LEVEL) / XP_PER_LEVEL) * 100}%`;
        }

        function showTab(tabId) {
            const targetTab = document.getElementById(tabId);
            const targetBtn = document.querySelector(`[data-target="${tabId}"]`);
            if (!targetTab || !targetBtn) return;
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('text-indigo-600', 'border-indigo-600', 'border-b-4'));
            targetTab.classList.add('active');
            targetBtn.classList.add('text-indigo-600', 'border-indigo-600', 'border-b-4');
            if(tabId === 'phase4') loadNewQuestion();
            if(tabId === 'phase2') updateStakeholders();
            if(tabId === 'phase3') refreshClaim();
        }

        function generateAREL() {
            const a = document.getElementById('arel-a').value;
            const r = document.getElementById('arel-r').value;
            const e = document.getElementById('arel-e').value;
            const l = document.getElementById('arel-l').value;
            if(!a || !r) return alert("Please fill at least Assertion and Reasoning!");
            document.getElementById('arel-text').innerText = `I firmly believe that ${a}. The reason is that ${r}. For example, ${e}. That is why I conclude that ${l}.`;
            document.getElementById('arel-result').classList.remove('hidden');
            addXP(50); unlockBadge('arel');
        }

        function unlockBadge(id) {
            state.badges[id] = true;
            const icons = document.querySelectorAll('#badge-preview i');
            const map = { arel: 0, stakeholder: 1, rebuttal: 2, fallacy: 3, speech: 4 };
            if (icons[map[id]]) {
                icons[map[id]].classList.replace('text-slate-500', 'text-yellow-400');
                icons[map[id]].classList.remove('badge-locked');
                icons[map[id]].classList.add('badge-unlocked');
            }
        }

        const stakeholderData = {
            edu: {
                list: [{ role: "Students (å­¸ç”Ÿ)", p: "More self-directed learning time." }, { role: "Teachers (è€å¸«)", p: "Curriculum quality vs. burnout." }, { role: "Low-income (å¼±å‹¢å®¶åº­)", p: "Reliance on school childcare." }],
                ref: "<b>æ ¸å¿ƒåˆ†æ (æ•™è‚²)ï¼š</b> æ”¯æŒè€…å¼·èª¿å……è¶³çš„ä¼‘æ¯èƒ½æå‡å­¸ç¿’è³ªé‡ï¼›åå°è€…æ“”å¿ƒå‡æœŸä¸­ç¼ºä¹è³‡æºçš„å­¸ç”Ÿæœƒé€ æˆå­¸åŠ›è½å¾Œã€‚"
            },
            tech: {
                list: [{ role: "Artists (è—è¡“å®¶)", p: "Livelihood & IP protection." }, { role: "Developers (é–‹ç™¼è€…)", p: "Innovation freedom." }, { role: "Judges (è©•å¯©)", p: "Defining original creativity." }],
                ref: "<b>æ ¸å¿ƒåˆ†æ (ç§‘æŠ€)ï¼š</b> AI æ˜¯å¦æ å¥ªäº†äººé¡çš„åŠªåŠ›æˆæœï¼Ÿæ”¯æŒè€…ä¸»å¼µå®ƒæ˜¯è¼”åŠ©å·¥å…·ï¼›åå°è€…å‰‡èªç‚ºå®ƒç ´å£äº†å‰µä½œçš„æœ¬è³ªåƒ¹å€¼ã€‚"
            },
            env: {
                list: [{ role: "Farmers (è¾²æ°‘)", p: "Survival of livestock business." }, { role: "Scientists (ç§‘å­¸å®¶)", p: "Urgency of methane reduction." }, { role: "Consumers (æ¶ˆè²»è€…)", p: "Groceries cost spikes." }],
                ref: "<b>æ ¸å¿ƒåˆ†æ (ç’°å¢ƒ)ï¼š</b> ç’°å¢ƒç¨…èƒ½å°æ­£é£²é£Ÿç¿’æ…£ï¼Œä½†å°åŸºå±¤å®¶åº­é€ æˆæ¥µå¤§çš„ç¶“æ¿Ÿå£“åŠ›ï¼Œæ¶‰åŠã€Œç”Ÿå­˜æ¬Š vs. æ°¸çºŒæ¬Šã€ã€‚"
            },
            econ: {
                list: [{ role: "Unemployed Workers (å¤±æ¥­è€…)", p: "Financial safety net & dignity." }, { role: "Employers (é›‡ä¸»)", p: "Difficulty in hiring low-skill labor." }, { role: "Gov Finance (è²¡æ”¿)", p: "Sustainability of tax funds." }],
                ref: "<b>æ ¸å¿ƒåˆ†æ (ç¶“æ¿Ÿ)ï¼š</b> UBI æ˜¯å¦æœƒæ¿€ç™¼å‰µæ„è¿½æ±‚ï¼Œé‚„æ˜¯æœƒå°è‡´ç¤¾æœƒæ•´é«”ç”Ÿç”¢åŠ›å´©æ½°ï¼Ÿé€™æ¶‰åŠå°äººæ€§å‹•åŠ›çš„åŸºæœ¬å‡è¨­ã€‚"
            },
            law: {
                list: [{ role: "Defendants (è¢«å‘Š)", p: "Privacy vs. Public trial rights." }, { role: "Public (å…¬çœ¾)", p: "Civic education & transparency." }, { role: "Witnesses (è­‰äºº)", p: "Pressure from public scrutiny." }],
                ref: "<b>æ ¸å¿ƒåˆ†æ (å¸æ³•)ï¼š</b> é€æ˜åº¦èˆ‡æ­£ç•¶ç¨‹åºçš„æ‹‰é‹¸ã€‚é–‹æ”¾è½‰æ’­æå‡å…¬çœ¾ä¿¡ä»»ï¼Œä½†ä¹Ÿå¯èƒ½è®“å¯©åˆ¤æ·ªç‚ºè¡¨æ¼”èˆ‡ç¶²è·¯å¯©åˆ¤ã€‚"
            }
        };

        function updateStakeholders() {
            const grid = document.getElementById('stakeholder-grid'); 
            const selector = document.getElementById('motion-selector');
            const refText = document.getElementById('ref-answer-text');
            if (!grid || !selector) return;
            grid.innerHTML = '';
            refText.classList.add('hidden');
            document.getElementById('ref-toggle-btn').innerText = 'è§£é–å°ˆå®¶åˆ†æ (åƒè€ƒè§£ç­”)';
            const data = stakeholderData[selector.value];
            data.list.forEach(item => {
                const div = document.createElement('div');
                div.className = "p-4 bg-emerald-50 rounded-xl border-2 border-emerald-100 card shadow-sm";
                div.innerHTML = `<div class='font-black text-emerald-700 text-[9px] uppercase mb-1'>${item.role}</div><p class='text-[11px] font-semibold text-slate-700'>${item.p}</p>`;
                grid.appendChild(div);
            });
            refText.innerHTML = data.ref;
        }

        function toggleRef() {
            const refText = document.getElementById('ref-answer-text');
            const btn = document.getElementById('ref-toggle-btn');
            if(refText.classList.contains('hidden')) {
                refText.classList.remove('hidden'); btn.innerText = 'éš±è—åˆ†æ'; addXP(5);
            } else {
                refText.classList.add('hidden'); btn.innerText = 'è§£é–å°ˆå®¶åˆ†æ (åƒè€ƒè§£ç­”)';
            }
        }

        const rebuttalChallenges = {
            edu: { claim: "4-day school weeks lead to students losing focus on academics.", ref: "1. They say focus drops. 2. But I disagree because rest prevents burnout. 3. Therefore, productivity increases on Monday. 4. Furthermore, it builds independent study habits." },
            tech: { claim: "AI art is great because it makes art creation fast and cheap.", ref: "1. They say AI saves time. 2. But I disagree because art is about human emotional journey. 3. Therefore, AI art is empty decoration. 4. Furthermore, it steals from human artists without credit." },
            env: { claim: "A meat tax is unfair because it punishes poor families.", ref: "1. They say it hits the poor. 2. But I disagree because revenue can subsidize healthy greens. 3. Therefore, it improves public health for everyone. 4. Furthermore, it's a global necessity for survival." },
            econ: { claim: "Universal Basic Income (UBI) will make people lazy.", ref: "1. They say people will quit jobs. 2. But I disagree because it provides a base for small businesses. 3. Therefore, it fosters innovation. 4. Furthermore, humans naturally seek purpose, not just laziness." },
            law: { claim: "Cameras in courtrooms will turn trials into a reality show.", ref: "1. They say it's sensationalism. 2. But I disagree because transparency checks corruption. 3. Therefore, justice becomes more accountable. 4. Furthermore, it's a vital civic education tool." }
        };

        function refreshClaim() {
            const sel = document.getElementById('rebuttal-topic-selector');
            const data = rebuttalChallenges[sel.value];
            document.getElementById('opponent-claim').innerText = `"${data.claim}"`;
            document.getElementById('rebuttal-ref-container').classList.add('hidden');
            document.getElementById('rebuttal-input').value = "";
        }

        function submitRebuttal() {
            const inp = document.getElementById('rebuttal-input');
            if(inp && inp.value.length < 15) return alert("Write more!");
            addXP(30); unlockBadge('rebuttal');
            const refText = document.getElementById('rebuttal-ref-text');
            const rawRef = rebuttalChallenges[document.getElementById('rebuttal-topic-selector').value].ref;
            refText.innerHTML = rawRef.split('. ').map((s, i) => `<p><b class="text-rose-600 text-[10px]">STEP ${i+1}:</b> ${s}</p>`).join('');
            document.getElementById('rebuttal-ref-container').classList.remove('hidden');
            confetti({ particleCount: 40, spread: 50, origin: { y: 0.8 } });
        }

        const fallacyQs = [
            { q: "You should trust this law because it's the law!", a: "Circular Reasoning" },
            { q: "Politician: Why ask about tax? I love my team!", a: "Red Herring" },
            { q: "If you try one soda, you'll die of sugar addiction!", a: "Slippery Slope" },
            { q: "Your point is wrong because you're a fool.", a: "Ad Hominem" },
            { q: "Either ban AI art or prepare for human death.", a: "False Dilemma" },
            { q: "A: Help the poor. B: So you want to steal?", a: "Strawman" }
        ];

        function loadNewQuestion() {
            const q = fallacyQs[Math.floor(Math.random() * fallacyQs.length)];
            document.getElementById('fallacy-q').innerText = `"${q.q}"`;
            state.currentQ = q;
        }

        function checkFallacy(btn, type) {
            if (type === state.currentQ.a) {
                state.streak++; addXP(25); confetti({ particleCount: 30 }); loadNewQuestion();
                if(state.streak >= 3) unlockBadge('fallacy');
            } else { state.streak = 0; btn.classList.add('bg-rose-100'); setTimeout(() => btn.classList.remove('bg-rose-100'), 500); }
            document.getElementById('streak-val').innerText = state.streak;
        }

        let timeLeft = 60; let timerInterval;
        function newTopic() {
            clearInterval(timerInterval); timeLeft = 60;
            const topics = ["Should school start at 11 AM?", "Are video games good for brains?", "Cats or Dogs?", "Is AI art real art?"];
            document.getElementById('random-topic').innerText = topics[Math.floor(Math.random() * topics.length)];
            document.getElementById('timer-btn').disabled = false;
            document.getElementById('timer-display').innerText = "01:00";
        }

        function toggleTimer() {
            const btn = document.getElementById('timer-btn');
            if (timerInterval) { clearInterval(timerInterval); timerInterval = null; btn.innerText = "ç¹¼çºŒ"; }
            else { btn.innerText = "æš«åœ"; timerInterval = setInterval(() => { 
                timeLeft--; 
                const m = Math.floor(timeLeft/60), s = timeLeft%60;
                document.getElementById('timer-display').innerText = `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
                if(timeLeft<=0) { clearInterval(timerInterval); addXP(100); unlockBadge('speech'); alert("Time's up!"); }
            }, 1000); }
        }

        window.onload = () => { updateUI(); updateStakeholders(); loadNewQuestion(); };
        function copyAREL() { 
            const el = document.createElement('textarea'); el.value = document.getElementById('arel-text').innerText;
            document.body.appendChild(el); el.select(); document.execCommand('copy'); document.body.removeChild(el); alert("Copied!"); 
        }
    </script>
</body>
</html>
